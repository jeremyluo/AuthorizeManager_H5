  <!DOCTYPE html>
  <html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>客户修改</title>
    <link rel="stylesheet" href="../layui/css/layui.css" media="all">
  <link rel="stylesheet" href="css/common.css" media="all">
    <style>
      body{margin: 10px;}
      .background{height: 200px; line-height: 200px; text-align: center;}
      .formback{}
      .liselected{display:block;padding:0 20px;color:#fff;color:rgba(255,255,255,.7);
        transition:all .3s;-webkit-transition:all .3s}
    </style>
  </head>
  <body class="layui-layout-body">
    
    <form class="layui-form" lay-filter="customerForm">
      <div class="layui-form">
        <div class="layui-form-item display-no">
          <label class="layui-form-label">ID</label>
          <div class="layui-input-inline">
            <input type="text" name="id" lay-verify="required" id="id" placeholder="ID" autocomplete="off" class="layui-input">
          </div>
        </div>

        <div class="layui-form-item">
          <label class="layui-form-label">客户名称</label>
          <div class="layui-input-inline">
            <input type="text" name="customerName" lay-verify="required" id="customerName" placeholder="请输入客户名称" autocomplete="off" class="layui-input">
          </div>
        </div>
        <div class="layui-form-item">
        <div class="layui-input-block">
          <button class="layui-btn layui-btn-radius layui-btn-normal" lay-submit lay-filter="customerEdit">修改</button>
          <button type="reset" class="layui-btn  layui-btn-radius layui-btn-primary">重置</button>
        </div>
      </div>
      </div>
    </form>
    
  <div class="loading-box">
     <div class="loading">
         <div class="loading-img">
             <img src="images/loading.gif">
         </div>
     </div>
  </div>
  <script src="../layui/layui.js"></script>
  <script>
  //JavaScript代码区域
  getParam();
  var id, name;
  function getParam() {
    var url = location.search.substring(1);//location.search得到的是？后面的数据: ?modelId='+data.id,substring() 方法用于提取字符串中介于两个指定下标之间的字符;得到的是去掉?的部分
    if (url != null && url != undefined && url != "") {  //表示，如果有参数；且不等于空，则进行分割得到data.id;
      id = url.split('&')[0].split('=')[1];　　　 //data.id;　
      name = url.split('&')[1].split('=')[1];　　　
    }
  }
  layui.config({base: '../res/js/'}).extend({
    cookie: 'module/cookie' 
  });
    layui.use(['element','form','layer', 'jquery', 'cookie'], function(){
      var element = layui.element
      ,form = layui.form
      ,layer = layui.layer
      ,$ = layui.jquery
      ,cookie = layui.cookie;

      form.val("customerForm",{
        "id":id,
        "customerName":name
      })

      //监听提交
      form.on('submit(customerEdit)', function(data){
      $.ajax({url:urlCustomerAdd,       
        method:'post',       
        data:data.field,        
        dataType:'JSON',  
        timeout:3000,
        headers:{token:$.cookie('the_cookie')},
        beforeSend:function(){
            $(".loading-box").show();
        },     
        success:function(res){       
          if(res.code='0'){
            layer.msg('添加客户成功'); 
            parent.closeIframe(res.msg);
          }                
          else{    
            layer.msg('添加客户失败,msg='+res.errorMessage);  
            alert(res.msg);   
          }
        },  
        //调用执行后调用的函数
        complete: function (XMLHttpRequest, textStatus) {
            $(".loading-box").hide();
            if(textStatus == 'timeout'){
                layer.msg('接口超时');
                // parent.closeIframe('');
                var index = parent.layer.getFrameIndex(window.name); //先得到当前iframe层的索引
                parent.layer.close(index); //再执行关闭
            }
            //刷新父页面
            parent.location.reload();
        },            
        error:function (data){
          layer.msg('操作失败');
        }           
      }); 
        return false;
      });
    });
  </script>
  </body>
  </html>        
          